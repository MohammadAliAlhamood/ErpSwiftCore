@using ErpSwiftCore.Web.Models.CompanySystemManagmentModels.CompanyBranchs
@using ErpSwiftCore.Web.ViewModels
@model CompanyBranchViewModel

@{
    bool isEdit = Model.CompanyBranch.Id != Guid.Empty;
    ViewData["Title"] = isEdit ? "Edit Branch" : "Create New Branch";
}

<section class="section">
    <div class="card">
        <div class="card-body">
            <h5 class="card-title">@ViewData["Title"]</h5>

            <form asp-action="Upsert" method="post" class="needs-validation" novalidate>
                @Html.AntiForgeryToken()
                <input type="hidden" asp-for="CompanyBranch.Id" />

                <!-- Branch Basics -->
                <div class="row mb-3">
                    <label class="col-sm-2 col-form-label">Branch Code</label>
                    <div class="col-sm-10">
                        <div class="form-floating">
                            <input asp-for="CompanyBranch.BranchCode" class="form-control" placeholder="Branch Code" />
                            <label asp-for="CompanyBranch.BranchCode">Branch Code</label>
                        </div>
                        <span asp-validation-for="CompanyBranch.BranchCode" class="text-danger small"></span>
                    </div>
                </div>

                <div class="row mb-5">
                    <label class="col-sm-2 col-form-label">Branch Name</label>
                    <div class="col-sm-10">
                        <div class="form-floating">
                            <input asp-for="CompanyBranch.BranchName" class="form-control" placeholder="Branch Name" />
                            <label asp-for="CompanyBranch.BranchName">Branch Name</label>
                        </div>
                        <span asp-validation-for="CompanyBranch.BranchName" class="text-danger small"></span>
                    </div>
                </div>

                <!-- Company Selector -->
                <div class="row mb-5">
                    <label class="col-sm-2 col-form-label">Company</label>
                    <div class="col-sm-10">
                        <div class="form-floating">
                            <select asp-for="CompanyBranch.CompanyID"
                                    asp-items="Model.CompanyList"
                                    class="form-select">
                                <option value="">-- Select Company --</option>
                            </select>
                            <label asp-for="CompanyBranch.CompanyID">Company</label>
                        </div>
                        <span asp-validation-for="CompanyBranch.CompanyID" class="text-danger small"></span>
                    </div>
                </div>

                <!-- Address -->
                <div class="row mb-3">
                    <label class="col-sm-2 col-form-label">Street</label>
                    <div class="col-sm-10">
                        <div class="form-floating">
                            <input asp-for="CompanyBranch.Address.Street" class="form-control" placeholder="Street" />
                            <label asp-for="CompanyBranch.Address.Street">Street</label>
                        </div>
                        <span asp-validation-for="CompanyBranch.Address.Street" class="text-danger small"></span>
                    </div>
                </div>
                <div class="row mb-3">
                    <label class="col-sm-2 col-form-label">City</label>
                    <div class="col-sm-10">
                        <div class="form-floating">
                            <input asp-for="CompanyBranch.Address.City" class="form-control" placeholder="City" />
                            <label asp-for="CompanyBranch.Address.City">City</label>
                        </div>
                        <span asp-validation-for="CompanyBranch.Address.City" class="text-danger small"></span>
                    </div>
                </div>
                <div class="row mb-3">
                    <label class="col-sm-2 col-form-label">State/Region</label>
                    <div class="col-sm-10">
                        <div class="form-floating">
                            <input asp-for="CompanyBranch.Address.State" class="form-control" placeholder="State/Region" />
                            <label asp-for="CompanyBranch.Address.State">State/Region</label>
                        </div>
                        <span asp-validation-for="CompanyBranch.Address.State" class="text-danger small"></span>
                    </div>
                </div>
                <div class="row mb-3">
                    <label class="col-sm-2 col-form-label">Postal Code</label>
                    <div class="col-sm-10">
                        <div class="form-floating">
                            <input asp-for="CompanyBranch.Address.PostalCode" class="form-control" placeholder="Postal Code" />
                            <label asp-for="CompanyBranch.Address.PostalCode">Postal Code</label>
                        </div>
                        <span asp-validation-for="CompanyBranch.Address.PostalCode" class="text-danger small"></span>
                    </div>
                </div>
                <div class="row mb-5">
                    <label class="col-sm-2 col-form-label">Country</label>
                    <div class="col-sm-10">
                        <div class="form-floating">
                            <input asp-for="CompanyBranch.Address.Country" class="form-control" placeholder="Country" />
                            <label asp-for="CompanyBranch.Address.Country">Country</label>
                        </div>
                        <span asp-validation-for="CompanyBranch.Address.Country" class="text-danger small"></span>
                    </div>
                </div>

                <!-- Contact Info -->
                <div class="row mb-3">
                    <label class="col-sm-2 col-form-label">Email</label>
                    <div class="col-sm-10">
                        <div class="input-group mb-1">
                            <span class="input-group-text"> </span>
                            <input asp-for="CompanyBranch.ContactInfo.Email" class="form-control" placeholder="email@example.com" />
                        </div>
                        <span asp-validation-for="CompanyBranch.ContactInfo.Email" class="text-danger small"></span>
                    </div>
                </div>
                <div class="row mb-3">
                    <label class="col-sm-2 col-form-label">Phone</label>
                    <div class="col-sm-10">
                        <div class="input-group mb-1">
                            <span class="input-group-text"><i class="bi bi-telephone"></i></span>
                            <input asp-for="CompanyBranch.ContactInfo.Phone" class="form-control" placeholder="Phone Number" />
                        </div>
                        <span asp-validation-for="CompanyBranch.ContactInfo.Phone" class="text-danger small"></span>
                    </div>
                </div>
                <div class="row mb-3">
                    <label class="col-sm-2 col-form-label">Mobile</label>
                    <div class="col-sm-10">
                        <div class="input-group mb-1">
                            <span class="input-group-text"><i class="bi bi-phone"></i></span>
                            <input asp-for="CompanyBranch.ContactInfo.Mobile" class="form-control" placeholder="Mobile Number" />
                        </div>
                        <span asp-validation-for="CompanyBranch.ContactInfo.Mobile" class="text-danger small"></span>
                    </div>
                </div>
                <div class="row mb-5">
                    <label class="col-sm-2 col-form-label">Fax</label>
                    <div class="col-sm-10">
                        <div class="input-group mb-1">
                            <span class="input-group-text"><i class="bi bi-printer"></i></span>
                            <input asp-for="CompanyBranch.ContactInfo.Fax" class="form-control" placeholder="Fax Number" />
                        </div>
                        <span asp-validation-for="CompanyBranch.ContactInfo.Fax" class="text-danger small"></span>
                    </div>
                </div>

                <!-- Actions -->
                <div class="text-end">
                    <a asp-action="Index" class="btn btn-outline-secondary me-2">Cancel</a>
                    <button type="submit" class="btn btn-success">
                        @(isEdit ? "Save Changes" : "Create Branch")
                    </button>
                </div>
            </form>
        </div>
    </div>
</section>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        (function () {
          'use strict';
          var forms = document.querySelectorAll('.needs-validation');
          Array.prototype.slice.call(forms).forEach(function (form) {
            form.addEventListener('submit', function (e) {
              if (!form.checkValidity()) {
                e.preventDefault();
                e.stopPropagation();
              }
              form.classList.add('was-validated');
            }, false);
          });
        })();
    </script>
}
